From d79143f85f4922ea52387c7cc44ad698a80c1938 Mon Sep 17 00:00:00 2001
From: David Abdurachmanov <davidlt@rivosinc.com>
Date: Mon, 27 Jun 2022 16:36:22 +0300
Subject: [PATCH] Enable "sbi" command and SBI reset

Signed-off-by: David Abdurachmanov <davidlt@rivosinc.com>
---
 configs/qemu-riscv64_defconfig       | 2 ++
 configs/qemu-riscv64_smode_defconfig | 1 +
 configs/sifive_unleashed_defconfig   | 2 ++
 configs/sifive_unmatched_defconfig   | 2 ++
 4 files changed, 7 insertions(+)

diff --git a/configs/qemu-riscv64_defconfig b/configs/qemu-riscv64_defconfig
index f7b9de10..f056ed91 100644
--- a/configs/qemu-riscv64_defconfig
+++ b/configs/qemu-riscv64_defconfig
@@ -16,3 +16,5 @@ CONFIG_CMD_NVEDIT_EFI=y
 CONFIG_SYS_RELOC_GD_ENV_ADDR=y
 CONFIG_DM_MTD=y
 CONFIG_SYS_MAX_FLASH_BANKS=2
+CONFIG_CMD_SBI=y
+CONFIG_SYSRESET_SBI=y
diff --git a/configs/qemu-riscv64_smode_defconfig b/configs/qemu-riscv64_smode_defconfig
index 4d83570c..97a4ec9e 100644
--- a/configs/qemu-riscv64_smode_defconfig
+++ b/configs/qemu-riscv64_smode_defconfig
@@ -20,3 +20,4 @@ CONFIG_SYS_RELOC_GD_ENV_ADDR=y
 CONFIG_DM_MTD=y
 CONFIG_SYS_MAX_FLASH_BANKS=2
 CONFIG_SYSRESET_SBI=y
+CONFIG_CMD_SBI=y
diff --git a/configs/sifive_unleashed_defconfig b/configs/sifive_unleashed_defconfig
index fe2227e5..81df9d06 100644
--- a/configs/sifive_unleashed_defconfig
+++ b/configs/sifive_unleashed_defconfig
@@ -30,3 +30,5 @@ CONFIG_SPL_DM_SEQ_ALIAS=y
 CONFIG_SPL_CLK=y
 CONFIG_DM_MTD=y
 CONFIG_DM_RESET=y
+CONFIG_CMD_SBI=y
+CONFIG_SYSRESET_SBI=y
diff --git a/configs/sifive_unmatched_defconfig b/configs/sifive_unmatched_defconfig
index 5d070843..f008f0f5 100644
--- a/configs/sifive_unmatched_defconfig
+++ b/configs/sifive_unmatched_defconfig
@@ -52,3 +52,5 @@ CONFIG_DM_SCSI=y
 CONFIG_USB=y
 CONFIG_USB_XHCI_HCD=y
 CONFIG_USB_XHCI_PCI=y
+CONFIG_CMD_SBI=y
+CONFIG_SYSRESET_SBI=y
-- 
2.35.1

